<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Image classification | Google Earth Engine workshop</title>
  <meta name="description" content="1 Image classification | Google Earth Engine workshop" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Image classification | Google Earth Engine workshop" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Image classification | Google Earth Engine workshop" />
  
  
  

<meta name="author" content="Philip Kraaijenbrink" />


<meta name="date" content="2020-10-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="quality-mosaicking.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#earth-engine-access"><i class="fa fa-check"></i>Earth Engine access</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#earth-engine-help"><i class="fa fa-check"></i>Earth Engine help</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#workshop-code"><i class="fa fa-check"></i>Workshop code</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#source"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="image-classification.html"><a href="image-classification.html"><i class="fa fa-check"></i><b>1</b> Image classification</a>
<ul>
<li class="chapter" data-level="1.1" data-path="image-classification.html"><a href="image-classification.html#define-input-data"><i class="fa fa-check"></i><b>1.1</b> Define input data</a></li>
<li class="chapter" data-level="1.2" data-path="image-classification.html"><a href="image-classification.html#obtain-training-data"><i class="fa fa-check"></i><b>1.2</b> Obtain training data</a></li>
<li class="chapter" data-level="1.3" data-path="image-classification.html"><a href="image-classification.html#classify-image"><i class="fa fa-check"></i><b>1.3</b> Classify image</a></li>
<li class="chapter" data-level="1.4" data-path="image-classification.html"><a href="image-classification.html#visualize-using-charts"><i class="fa fa-check"></i><b>1.4</b> Visualize using charts</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="quality-mosaicking.html"><a href="quality-mosaicking.html"><i class="fa fa-check"></i><b>2</b> Quality mosaicking</a>
<ul>
<li class="chapter" data-level="2.1" data-path="quality-mosaicking.html"><a href="quality-mosaicking.html#define-input-data-1"><i class="fa fa-check"></i><b>2.1</b> Define input data</a></li>
<li class="chapter" data-level="2.2" data-path="quality-mosaicking.html"><a href="quality-mosaicking.html#mask-clouds-and-calculate-index"><i class="fa fa-check"></i><b>2.2</b> Mask clouds and calculate index</a></li>
<li class="chapter" data-level="2.3" data-path="quality-mosaicking.html"><a href="quality-mosaicking.html#quality-mosaic-composite"><i class="fa fa-check"></i><b>2.3</b> Quality mosaic composite</a></li>
<li class="chapter" data-level="2.4" data-path="quality-mosaicking.html"><a href="quality-mosaicking.html#classify-water"><i class="fa fa-check"></i><b>2.4</b> Classify water</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>3</b> Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="regression.html"><a href="regression.html#settings-and-data"><i class="fa fa-check"></i><b>3.1</b> Settings and data</a></li>
<li class="chapter" data-level="3.2" data-path="regression.html"><a href="regression.html#derive-annual-composites"><i class="fa fa-check"></i><b>3.2</b> Derive annual composites</a></li>
<li class="chapter" data-level="3.3" data-path="regression.html"><a href="regression.html#calculate-temporal-trend"><i class="fa fa-check"></i><b>3.3</b> Calculate temporal trend</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="climate-data-analysis.html"><a href="climate-data-analysis.html"><i class="fa fa-check"></i><b>4</b> Climate data analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="climate-data-analysis.html"><a href="climate-data-analysis.html#define-input-data-2"><i class="fa fa-check"></i><b>4.1</b> Define input data</a></li>
<li class="chapter" data-level="4.2" data-path="climate-data-analysis.html"><a href="climate-data-analysis.html#estimate-mean-temperature"><i class="fa fa-check"></i><b>4.2</b> Estimate mean temperature</a></li>
<li class="chapter" data-level="4.3" data-path="climate-data-analysis.html"><a href="climate-data-analysis.html#determine-relative-change"><i class="fa fa-check"></i><b>4.3</b> Determine relative change</a></li>
<li class="chapter" data-level="4.4" data-path="climate-data-analysis.html"><a href="climate-data-analysis.html#make-charts"><i class="fa fa-check"></i><b>4.4</b> Make charts</a></li>
<li class="chapter" data-level="4.5" data-path="climate-data-analysis.html"><a href="climate-data-analysis.html#end-of-century-climatology"><i class="fa fa-check"></i><b>4.5</b> End of century climatology</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="additional-cases.html"><a href="additional-cases.html"><i class="fa fa-check"></i>Additional cases</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Google Earth Engine workshop</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="image-classification" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Image classification</h1>
<p><strong>Generate a Landsat 8 composite image, perform a landcover classification of the image, and compare class distribution over elevation in the Netherlands.</strong></p>
<div id="define-input-data" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Define input data</h2>
<p>First you will need to define the datasets to use. In this exercise you will use Landsat 8 surface reflectance data, AHN elevation data, and vector outlines of the Netherlands and dutch provinces. Copy and paste the lines below to a blank script:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb1-1"><a href="image-classification.html#cb1-1"></a><span class="co">// get landsat data from catalog</span></span>
<span id="cb1-2"><a href="image-classification.html#cb1-2"></a><span class="kw">var</span> landsat  <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;LANDSAT/LC08/C01/T1_SR&#39;</span>)</span>
<span id="cb1-3"><a href="image-classification.html#cb1-3"></a> </span>
<span id="cb1-4"><a href="image-classification.html#cb1-4"></a><span class="co">// get only scenes that overlap with NL, have less than 10% cloud cover, and</span></span>
<span id="cb1-5"><a href="image-classification.html#cb1-5"></a><span class="co">// fall in the period 2015-2017</span></span>
<span id="cb1-6"><a href="image-classification.html#cb1-6"></a><span class="kw">var</span> nl      <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&#39;users/philipkraaijenbrink/dpg-workshop/rijksgrens_nl&#39;</span>)</span>
<span id="cb1-7"><a href="image-classification.html#cb1-7"></a><span class="kw">var</span> landsat <span class="op">=</span> landsat<span class="op">.</span><span class="fu">filterBounds</span>(nl)</span>
<span id="cb1-8"><a href="image-classification.html#cb1-8"></a>                     <span class="op">.</span><span class="fu">filterDate</span>(<span class="st">&#39;2015-01-01&#39;</span><span class="op">,</span><span class="st">&#39;2017-12-31&#39;</span>)</span>
<span id="cb1-9"><a href="image-classification.html#cb1-9"></a>                     <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">lte</span>(<span class="st">&#39;CLOUD_COVER&#39;</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb1-10"><a href="image-classification.html#cb1-10"></a> </span>
<span id="cb1-11"><a href="image-classification.html#cb1-11"></a><span class="co">// select subsat of image bands and rename them for easier reference</span></span>
<span id="cb1-12"><a href="image-classification.html#cb1-12"></a><span class="co">// first select band subset, then loop over images in collection and rename the bands</span></span>
<span id="cb1-13"><a href="image-classification.html#cb1-13"></a><span class="kw">var</span> landsat <span class="op">=</span> landsat</span>
<span id="cb1-14"><a href="image-classification.html#cb1-14"></a>  <span class="op">.</span><span class="fu">select</span>([<span class="st">&#39;B2&#39;</span><span class="op">,</span><span class="st">&#39;B3&#39;</span><span class="op">,</span><span class="st">&#39;B4&#39;</span><span class="op">,</span><span class="st">&#39;B5&#39;</span><span class="op">,</span><span class="st">&#39;B6&#39;</span><span class="op">,</span><span class="st">&#39;B7&#39;</span><span class="op">,</span><span class="st">&#39;B10&#39;</span>]) </span>
<span id="cb1-15"><a href="image-classification.html#cb1-15"></a>  <span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(x){<span class="cf">return</span> x<span class="op">.</span><span class="fu">rename</span>([<span class="st">&#39;blue&#39;</span><span class="op">,</span><span class="st">&#39;green&#39;</span><span class="op">,</span><span class="st">&#39;red&#39;</span><span class="op">,</span> <span class="st">&#39;nir&#39;</span><span class="op">,</span><span class="st">&#39;swir1&#39;</span><span class="op">,</span><span class="st">&#39;swir2&#39;</span><span class="op">,</span><span class="st">&#39;tir&#39;</span>])})</span></code></pre></div>
<p> </p>
<p>To get a quick cloud free composite of the filtered Landsat 8 image collection, use a median reducer to generate a single composite image whose pixels comprise the median value of the collection. Using the median makes sure that the cloud pixels are not selected because they are always close to the maximum values.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb2-1"><a href="image-classification.html#cb2-1"></a><span class="co">// for every pixel, get the median pixel value of all images in the collection</span></span>
<span id="cb2-2"><a href="image-classification.html#cb2-2"></a><span class="co">// for a quick way to filter clouds and possible artefacts</span></span>
<span id="cb2-3"><a href="image-classification.html#cb2-3"></a><span class="kw">var</span> satimg <span class="op">=</span> landsat<span class="op">.</span><span class="fu">median</span>()</span>
<span id="cb2-4"><a href="image-classification.html#cb2-4"></a> </span>
<span id="cb2-5"><a href="image-classification.html#cb2-5"></a><span class="co">// clip the result to the outline of NL</span></span>
<span id="cb2-6"><a href="image-classification.html#cb2-6"></a><span class="kw">var</span> satimg <span class="op">=</span> satimg<span class="op">.</span><span class="fu">clip</span>(nl)</span></code></pre></div>
</div>
<div id="obtain-training-data" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Obtain training data</h2>
<p>Visualize the data using <code>Map.addLayer()</code>, similar to example code on the previous page. Select a band combination that clearly shows the different land cover types.</p>
<p>To perform classification of the composite image you first need to define training data. This is performed by drawing polygons on the image to sample pixels of a land cover class. In this exercise you will classify the following classes:
<em>grassland, forest, water, built-up, bare, cropland</em></p>
<p>Draw polygons for each of the land cover classes using the drawing tools of Earth Engine (in the top left corner of the map). Do not make the polygon too large and try to limit contamination by pixels that are not supposed to be part of the class, e.g. do not let the built-up polygon partly cover a park.</p>
<p>For each class, you should generate a new layer. In the layer settings (accessible via the gear icon that appears when hovering over the layer) give the layer a name, set the import type to ‘feature’ and add a property “class”. Set the class value for each cover type to a unique numerical value (0 to 5). If necessary, there can be multiple polygons per class. Don’t mind the colors for now, you will assign them in a later stage.</p>
<p> </p>
<div class="figure"><span id="fig:unnamed-chunk-5"></span>
<img src="figures/drawing-tools.png" alt="Drawing tools and layers currently drawn." width="317 px" />
<p class="caption">
Figure 1.1: Drawing tools and layers currently drawn.
</p>
</div>
<p> </p>
<div class="figure"><span id="fig:unnamed-chunk-6"></span>
<img src="figures/geometry-settings-dialog.png" alt="The geometry settings dialog." width="395 px" />
<p class="caption">
Figure 1.2: The geometry settings dialog.
</p>
</div>
<p> </p>
<p>When you have created the polygons for all classes, combine them into a feature collection using the following code (check whether the layer names match yours).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb3-1"><a href="image-classification.html#cb3-1"></a><span class="co">// combine the sample regions you&#39;ve create into a single collection</span></span>
<span id="cb3-2"><a href="image-classification.html#cb3-2"></a><span class="kw">var</span> sampleregs  <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>([grass<span class="op">,</span>forest<span class="op">,</span>water<span class="op">,</span>built_up<span class="op">,</span>bare<span class="op">,</span>crop])</span></code></pre></div>
</div>
<div id="classify-image" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Classify image</h2>
<p>Using the polygons, we will now sample pixels from the image and use them as training data for the classification algorithm. You will use a simple minimum distance classifier, but there are many more advanced options available. To generate the classified image use:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb4-1"><a href="image-classification.html#cb4-1"></a><span class="co">// selection of bands to use for classification algorithm</span></span>
<span id="cb4-2"><a href="image-classification.html#cb4-2"></a><span class="kw">var</span> bands   <span class="op">=</span> [<span class="st">&#39;green&#39;</span><span class="op">,</span><span class="st">&#39;red&#39;</span><span class="op">,</span><span class="st">&#39;nir&#39;</span><span class="op">,</span><span class="st">&#39;swir1&#39;</span><span class="op">,</span><span class="st">&#39;swir2&#39;</span>]</span>
<span id="cb4-3"><a href="image-classification.html#cb4-3"></a> </span>
<span id="cb4-4"><a href="image-classification.html#cb4-4"></a><span class="co">// sample pixels from the image using the regions</span></span>
<span id="cb4-5"><a href="image-classification.html#cb4-5"></a><span class="kw">var</span> training <span class="op">=</span> satimg<span class="op">.</span><span class="fu">sampleRegions</span>({</span>
<span id="cb4-6"><a href="image-classification.html#cb4-6"></a>  <span class="dt">collection</span><span class="op">:</span> sampleregs<span class="op">,</span></span>
<span id="cb4-7"><a href="image-classification.html#cb4-7"></a>  <span class="dt">properties</span><span class="op">:</span> [<span class="st">&#39;class&#39;</span>]<span class="op">,</span></span>
<span id="cb4-8"><a href="image-classification.html#cb4-8"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">30</span></span>
<span id="cb4-9"><a href="image-classification.html#cb4-9"></a>})</span>
<span id="cb4-10"><a href="image-classification.html#cb4-10"></a></span>
<span id="cb4-11"><a href="image-classification.html#cb4-11"></a><span class="co">// define classifier and train with the samples</span></span>
<span id="cb4-12"><a href="image-classification.html#cb4-12"></a><span class="kw">var</span> mdmodel  <span class="op">=</span> ee<span class="op">.</span><span class="at">Classifier</span><span class="op">.</span><span class="fu">minimumDistance</span>(<span class="st">&#39;euclidean&#39;</span>)</span>
<span id="cb4-13"><a href="image-classification.html#cb4-13"></a><span class="kw">var</span> trained  <span class="op">=</span> mdmodel<span class="op">.</span><span class="fu">train</span>(training<span class="op">,</span> <span class="st">&#39;class&#39;</span><span class="op">,</span> bands)</span>
<span id="cb4-14"><a href="image-classification.html#cb4-14"></a></span>
<span id="cb4-15"><a href="image-classification.html#cb4-15"></a><span class="co">// apply classifier to the image</span></span>
<span id="cb4-16"><a href="image-classification.html#cb4-16"></a><span class="kw">var</span> classimg <span class="op">=</span> satimg<span class="op">.</span><span class="fu">classify</span>(trained)</span></code></pre></div>
<p> </p>
<p>Define a list with class names, values and display colors to use for mapping and charting:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb5-1"><a href="image-classification.html#cb5-1"></a><span class="co">// lists with class names, values and colors (for colors use hex RGB or html5 color names)</span></span>
<span id="cb5-2"><a href="image-classification.html#cb5-2"></a><span class="kw">var</span> classlab <span class="op">=</span> [<span class="st">&#39;Grassland&#39;</span><span class="op">,</span><span class="st">&#39;Forest&#39;</span><span class="op">,</span><span class="st">&#39;Water&#39;</span><span class="op">,</span><span class="st">&#39;Built-up&#39;</span><span class="op">,</span><span class="st">&#39;Bare&#39;</span><span class="op">,</span><span class="st">&#39;Cropland&#39;</span>]</span>
<span id="cb5-3"><a href="image-classification.html#cb5-3"></a><span class="kw">var</span> classval <span class="op">=</span> [<span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">4</span><span class="op">,</span><span class="dv">5</span>]</span>
<span id="cb5-4"><a href="image-classification.html#cb5-4"></a><span class="kw">var</span> classcol <span class="op">=</span> [<span class="st">&#39;YellowGreen&#39;</span><span class="op">,</span> <span class="st">&#39;184930&#39;</span><span class="op">,</span> <span class="st">&#39;LightSkyBlue&#39;</span><span class="op">,</span> <span class="st">&#39;#cacaca&#39;</span><span class="op">,</span> <span class="st">&#39;Moccasin&#39;</span><span class="op">,</span> <span class="st">&#39;OliveDrab&#39;</span>]  </span></code></pre></div>
<p> </p>
<p>Add the classification to the map using:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb6-1"><a href="image-classification.html#cb6-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(classimg<span class="op">,</span> {<span class="dt">min</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span><span class="dv">5</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> classcol}<span class="op">,</span> <span class="st">&#39;Classification&#39;</span><span class="op">,</span><span class="kw">true</span>)</span></code></pre></div>
<p> </p>
<p>If you would like, you can add a quick legend to the map using this predefined function:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb7-1"><a href="image-classification.html#cb7-1"></a><span class="kw">var</span> lg <span class="op">=</span> <span class="pp">require</span>(<span class="st">&#39;users/philipkraaijenbrink/tools:legends&#39;</span>)</span>
<span id="cb7-2"><a href="image-classification.html#cb7-2"></a>lg<span class="op">.</span><span class="fu">classLegend</span>(classval<span class="op">,</span> classlab<span class="op">,</span> classcol)</span></code></pre></div>
<p> </p>
<p>Evaluate the classification accuracy. Has it performed well? If not, change your polygons and/or add extra.</p>
</div>
<div id="visualize-using-charts" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Visualize using charts</h2>
<p>To get information about the class distribution in the Netherlands, generate a barchart showing approximate area per class. This can be done using the following code:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb8-1"><a href="image-classification.html#cb8-1"></a><span class="co">// chart that shows class area distribution</span></span>
<span id="cb8-2"><a href="image-classification.html#cb8-2"></a><span class="kw">var</span> nl <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&#39;users/philipkraaijenbrink/dpg-workshop/rijksgrens_nl&#39;</span>)</span>
<span id="cb8-3"><a href="image-classification.html#cb8-3"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">byClass</span>({</span>
<span id="cb8-4"><a href="image-classification.html#cb8-4"></a>  <span class="dt">image</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Image</span><span class="op">.</span><span class="fu">pixelArea</span>()<span class="op">.</span><span class="fu">multiply</span>(<span class="fl">1e-6</span>)        <span class="co">// pixel area in km2</span></span>
<span id="cb8-5"><a href="image-classification.html#cb8-5"></a>            <span class="op">.</span><span class="fu">addBands</span>(classimg<span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;classification&#39;</span>))<span class="op">,</span></span>
<span id="cb8-6"><a href="image-classification.html#cb8-6"></a>  <span class="dt">classBand</span><span class="op">:</span> <span class="st">&#39;classification&#39;</span><span class="op">,</span>                     </span>
<span id="cb8-7"><a href="image-classification.html#cb8-7"></a>  <span class="dt">region</span><span class="op">:</span> nl<span class="op">,</span></span>
<span id="cb8-8"><a href="image-classification.html#cb8-8"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>()<span class="op">,</span></span>
<span id="cb8-9"><a href="image-classification.html#cb8-9"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">30</span><span class="op">*</span><span class="dv">30</span><span class="op">,</span></span>
<span id="cb8-10"><a href="image-classification.html#cb8-10"></a>  <span class="dt">classLabels</span><span class="op">:</span> classlab<span class="op">,</span></span>
<span id="cb8-11"><a href="image-classification.html#cb8-11"></a>})</span>
<span id="cb8-12"><a href="image-classification.html#cb8-12"></a>chart<span class="op">.</span><span class="fu">setOptions</span>({<span class="dt">title</span><span class="op">:</span><span class="st">&#39;Area per class&#39;</span><span class="op">,</span> <span class="dt">hAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;&#39;</span>}<span class="op">,</span> <span class="dt">vAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Area (km2)&#39;</span>}<span class="op">,</span></span>
<span id="cb8-13"><a href="image-classification.html#cb8-13"></a>                 <span class="dt">colors</span><span class="op">:</span> classcol})</span>
<span id="cb8-14"><a href="image-classification.html#cb8-14"></a>     <span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;ColumnChart&#39;</span>)</span>
<span id="cb8-15"><a href="image-classification.html#cb8-15"></a>print(chart)</span></code></pre></div>
<p> </p>
<p>To get a sense of class distribution with elevation in the Netherlands, first extract elevation bands from the detailed 0.5 m resolution elevation model Algemeen Hoogtebestand Nederland (AHN):</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb9-1"><a href="image-classification.html#cb9-1"></a><span class="co">// get equidistant elevation bands from AHN for charting</span></span>
<span id="cb9-2"><a href="image-classification.html#cb9-2"></a><span class="kw">var</span> elev <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(<span class="st">&#39;AHN/AHN2_05M_INT&#39;</span>)     <span class="co">// get AHN dataset from catalog</span></span>
<span id="cb9-3"><a href="image-classification.html#cb9-3"></a><span class="kw">var</span> stepping  <span class="op">=</span> <span class="fl">1.0</span>                         <span class="co">// elevation step size</span></span>
<span id="cb9-4"><a href="image-classification.html#cb9-4"></a><span class="kw">var</span> elevsteps <span class="op">=</span> ee<span class="op">.</span><span class="at">List</span><span class="op">.</span><span class="fu">sequence</span>(<span class="op">-</span><span class="dv">5</span><span class="op">,</span><span class="dv">50</span><span class="op">,</span>stepping)     <span class="co">// get steps in range</span></span>
<span id="cb9-5"><a href="image-classification.html#cb9-5"></a><span class="kw">var</span> itr <span class="op">=</span> ee<span class="op">.</span><span class="at">List</span><span class="op">.</span><span class="fu">sequence</span>(<span class="dv">0</span><span class="op">,</span>elevsteps<span class="op">.</span><span class="fu">length</span>()<span class="op">.</span><span class="fu">subtract</span>(<span class="dv">1</span>)<span class="op">,</span><span class="dv">1</span>)  <span class="co">// iterator list to loop over</span></span>
<span id="cb9-6"><a href="image-classification.html#cb9-6"></a><span class="kw">var</span> elevbands   <span class="op">=</span> ee<span class="op">.</span><span class="at">ImageCollection</span><span class="op">.</span><span class="fu">fromImages</span>(itr<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(i){  <span class="co">// loop over iterator i</span></span>
<span id="cb9-7"><a href="image-classification.html#cb9-7"></a>  <span class="kw">var</span> elevthres <span class="op">=</span>  ee<span class="op">.</span><span class="fu">Number</span>(elevsteps<span class="op">.</span><span class="fu">get</span>(i))                        <span class="co">// get elev_i</span></span>
<span id="cb9-8"><a href="image-classification.html#cb9-8"></a>  <span class="kw">var</span> elevband <span class="op">=</span> elev<span class="op">.</span><span class="fu">lte</span>(elevthres)<span class="op">.</span><span class="fu">and</span>(elev<span class="op">.</span><span class="fu">gt</span>(elevthres<span class="op">.</span><span class="fu">subtract</span>(stepping))) <span class="co">// elev band</span></span>
<span id="cb9-9"><a href="image-classification.html#cb9-9"></a>  <span class="kw">var</span> onlyband <span class="op">=</span> elevband<span class="op">.</span><span class="fu">updateMask</span>(elevband<span class="op">.</span><span class="fu">eq</span>(<span class="dv">1</span>))         <span class="co">// mask everything but true</span></span>
<span id="cb9-10"><a href="image-classification.html#cb9-10"></a>  <span class="cf">return</span> onlyband<span class="op">.</span><span class="fu">set</span>(<span class="st">&#39;system:index&#39;</span><span class="op">,</span>ee<span class="op">.</span><span class="at">Number</span><span class="op">.</span><span class="fu">parse</span>(i)<span class="op">.</span><span class="fu">format</span>(<span class="st">&#39;%04d&#39;</span>))  <span class="co">// set image index</span></span>
<span id="cb9-11"><a href="image-classification.html#cb9-11"></a>}))</span></code></pre></div>
<p> </p>
<p>Make a chart of the elevation bands that evaluates the area per class per elevation band:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb10-1"><a href="image-classification.html#cb10-1"></a><span class="co">// make chart of pixel count per class per elevation band</span></span>
<span id="cb10-2"><a href="image-classification.html#cb10-2"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">byClass</span>({</span>
<span id="cb10-3"><a href="image-classification.html#cb10-3"></a>  <span class="dt">image</span><span class="op">:</span> elevbands<span class="op">.</span><span class="fu">toBands</span>()<span class="op">.</span><span class="fu">addBands</span>(classimg<span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;classification&#39;</span>))<span class="op">,</span></span>
<span id="cb10-4"><a href="image-classification.html#cb10-4"></a>  <span class="dt">classBand</span><span class="op">:</span> <span class="st">&#39;classification&#39;</span><span class="op">,</span></span>
<span id="cb10-5"><a href="image-classification.html#cb10-5"></a>  <span class="dt">region</span><span class="op">:</span> nl<span class="op">,</span></span>
<span id="cb10-6"><a href="image-classification.html#cb10-6"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>()<span class="op">,</span></span>
<span id="cb10-7"><a href="image-classification.html#cb10-7"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">30</span><span class="op">*</span><span class="dv">30</span><span class="op">,</span></span>
<span id="cb10-8"><a href="image-classification.html#cb10-8"></a>  <span class="dt">classLabels</span><span class="op">:</span> classlab<span class="op">,</span></span>
<span id="cb10-9"><a href="image-classification.html#cb10-9"></a>  <span class="dt">xLabels</span><span class="op">:</span> elevsteps<span class="op">.</span><span class="fu">getInfo</span>()<span class="op">,</span></span>
<span id="cb10-10"><a href="image-classification.html#cb10-10"></a>})</span>
<span id="cb10-11"><a href="image-classification.html#cb10-11"></a>chart<span class="op">.</span><span class="fu">setOptions</span>({<span class="dt">title</span><span class="op">:</span><span class="st">&#39;Land cover with elevation&#39;</span><span class="op">,</span> <span class="dt">hAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Elevation (m)&#39;</span>}<span class="op">,</span></span>
<span id="cb10-12"><a href="image-classification.html#cb10-12"></a>                <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">pointSize</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">colors</span><span class="op">:</span> classcol<span class="op">,</span> <span class="dt">isStacked</span><span class="op">:</span> <span class="st">&#39;absolute&#39;</span>})</span>
<span id="cb10-13"><a href="image-classification.html#cb10-13"></a>     <span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;AreaChart&#39;</span>)</span>
<span id="cb10-14"><a href="image-classification.html#cb10-14"></a>print(chart)</span></code></pre></div>
<p> </p>
<p>To determine the fractional coverage of each elevation band, change the string <em>absolute</em> to <em>relative</em> or <em>percent</em> in the <code>setOptions()</code> function in the code above.</p>
<p>You can also summarize images for every region in a vector dataset using <code>ui.Chart.image.byRegion()</code>. For example class area per province in the Netherlands:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb11-1"><a href="image-classification.html#cb11-1"></a><span class="co">// make a chart for class distribution in each province</span></span>
<span id="cb11-2"><a href="image-classification.html#cb11-2"></a><span class="kw">var</span> prov <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&#39;users/philipkraaijenbrink/dpg-workshop/provincies_nl&#39;</span>)</span>
<span id="cb11-3"><a href="image-classification.html#cb11-3"></a><span class="kw">var</span> sepclass <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(ee<span class="op">.</span><span class="fu">List</span>(classval)<span class="op">.</span><span class="fu">iterate</span>(</span>
<span id="cb11-4"><a href="image-classification.html#cb11-4"></a>  <span class="kw">function</span>(x<span class="op">,</span>y){<span class="cf">return</span> ee<span class="op">.</span><span class="fu">Image</span>(y)<span class="op">.</span><span class="fu">addBands</span>(classimg<span class="op">.</span><span class="fu">eq</span>(ee<span class="op">.</span><span class="at">Image</span><span class="op">.</span><span class="fu">constant</span>(x)))}<span class="op">,</span></span>
<span id="cb11-5"><a href="image-classification.html#cb11-5"></a>  ee<span class="op">.</span><span class="fu">Image</span>()<span class="op">.</span><span class="fu">select</span>()))</span>
<span id="cb11-6"><a href="image-classification.html#cb11-6"></a><span class="kw">var</span> chartlab <span class="op">=</span> []<span class="op">;</span> classval<span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span>(val<span class="op">,</span>i){chartlab<span class="op">.</span><span class="fu">push</span>(val<span class="op">+</span><span class="st">&#39; &#39;</span><span class="op">+</span>classlab[i])})<span class="op">;</span></span>
<span id="cb11-7"><a href="image-classification.html#cb11-7"></a><span class="kw">var</span> chart <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">byRegion</span>({</span>
<span id="cb11-8"><a href="image-classification.html#cb11-8"></a>  <span class="dt">image</span><span class="op">:</span> sepclass<span class="op">.</span><span class="fu">rename</span>(chartlab)<span class="op">,</span></span>
<span id="cb11-9"><a href="image-classification.html#cb11-9"></a>  <span class="dt">regions</span><span class="op">:</span> prov<span class="op">,</span></span>
<span id="cb11-10"><a href="image-classification.html#cb11-10"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>()<span class="op">,</span></span>
<span id="cb11-11"><a href="image-classification.html#cb11-11"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">30</span><span class="op">*</span><span class="dv">30</span><span class="op">,</span></span>
<span id="cb11-12"><a href="image-classification.html#cb11-12"></a>  <span class="dt">xProperty</span><span class="op">:</span> <span class="st">&#39;provincien&#39;</span><span class="op">,</span></span>
<span id="cb11-13"><a href="image-classification.html#cb11-13"></a>})<span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;ColumnChart&#39;</span>)<span class="op">.</span><span class="fu">setOptions</span>({<span class="dt">colors</span><span class="op">:</span> classcol<span class="op">,</span> <span class="dt">isStacked</span><span class="op">:</span> <span class="st">&#39;percent&#39;</span>})</span>
<span id="cb11-14"><a href="image-classification.html#cb11-14"></a>print(chart)</span></code></pre></div>
<p> </p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="quality-mosaicking.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
